<div *ngIf="currentBook && selectedChapterIndex >= 0 && selectedChapterIndex < currentBook.chapters.length"
         class="bg-white border rounded p-4 shadow-sm">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold">
          {{ currentBook.name }} {{ selectedChapter }}
          <span *ngIf="chapterProgress?.completed" class="ml-2 text-sm bg-green-100 text-green-800 px-2 py-1 rounded">
            Completed
          </span>
          <span *ngIf="!chapterProgress?.completed && chapterProgress?.inProgress"
                class="ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded">
            In Progress
          </span>
        </h3>
        <span class="text-gray-600">
          {{ memorizedCount }} / {{ totalVerses }} verses
        </span>
      </div>

      <!-- Progress Details -->
      <div class="mb-4">
        <div class="flex flex-col space-y-1">
          <p class="text-sm text-gray-600">Total verses: {{ totalVerses }}</p>
          <p class="text-sm text-gray-600">Memorized: {{ memorizedCount }}</p>
          <p class="text-sm text-gray-600">
            Remaining: {{ totalVerses - memorizedCount }}
          </p>
          <p class="text-sm text-gray-600">
            Progress: {{ progressPercent }}%
          </p>
        </div>
      </div>

      <!-- Verse Selector Component -->
      <app-verse-selector
        [totalVerses]="totalVerses"
        [versesMemorized]="chapterProgress.versesMemorized || []"
        (versesChange)="onVersesChange($event)"
      ></app-verse-selector>
    </div>

    <!-- Confirmation Modal -->
    <app-confirmation-modal
      [isVisible]="isConfirmModalVisible"
      [title]="'Reset Chapter'"
      [message]="'Are you sure you want to reset progress for Chapter ' + selectedChapter + '? This action cannot be undone.'"
      [confirmText]="'Reset'"
      (confirm)="confirmReset()"
      (cancel)="cancelReset()"
    ></app-confirmation-modal>