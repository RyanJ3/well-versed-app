<!-- frontend/src/app/components/verse-range-picker/verse-picker.component.html -->
<div class="verse-picker" [ngClass]="'theme-' + theme">
  <!-- Mode Selector -->
  <div class="mode-selector">
    <button 
      class="mode-option" 
      [class.active]="mode === 'single'"
      (click)="onModeChange('single')">
      Single Verse
    </button>
    <button 
      class="mode-option" 
      [class.active]="mode === 'range'"
      (click)="onModeChange('range')">
      Verse Range
    </button>
    <button 
      class="mode-option" 
      [class.active]="mode === 'chapter'"
      (click)="onModeChange('chapter')">
      Whole Chapter
    </button>
  </div>

  <!-- Filters -->
  <div class="filters-section" *ngIf="showFilters">
    <label class="filter-option">
      <input 
        type="checkbox" 
        [(ngModel)]="showMemorizedOnly"
        (change)="toggleMemorizedFilter()">
      <span class="checkbox-custom"></span>
      Show memorized verses only
    </label>
  </div>

  <!-- Picker Controls -->
  <div class="picker-container">
    <!-- Start/Single Verse Selection -->
    <div class="picker-group start-group">
      <label class="group-label">
        <span *ngIf="mode === 'single'">Select Verse</span>
        <span *ngIf="mode === 'range'">Start Verse</span>
        <span *ngIf="mode === 'chapter'">Select Chapter</span>
      </label>
      
      <div class="picker-controls">
        <div class="control-group">
          <label class="control-label">Book</label>
          <select 
            [(ngModel)]="selectedBook" 
            (ngModelChange)="onBookChange()"
            class="select-control book-select">
            <option *ngFor="let book of books" [ngValue]="book">
              {{ book.name }}
            </option>
          </select>
        </div>

        <div class="control-group">
          <label class="control-label">Chapter</label>
          <select 
            [(ngModel)]="selectedChapter" 
            (ngModelChange)="onChapterChange()"
            class="select-control">
            <option *ngFor="let chapter of chapters" [value]="chapter">
              {{ chapter }}
            </option>
          </select>
        </div>

        <span class="separator" *ngIf="mode !== 'chapter'">:</span>

        <div class="control-group" *ngIf="mode !== 'chapter'">
          <label class="control-label">Verse</label>
          <select 
            [(ngModel)]="selectedVerse" 
            (ngModelChange)="onVerseChange()"
            class="select-control">
            <option *ngFor="let verse of verses" [value]="verse">
              {{ verse }}
            </option>
          </select>
        </div>
      </div>
    </div>

    <!-- Range Arrow -->
    <div class="range-connector" *ngIf="mode === 'range'">
      <span class="arrow">â†’</span>
    </div>

    <!-- End Verse Selection (Range Mode) -->
    <div class="picker-group end-group" *ngIf="mode === 'range'">
      <label class="group-label">End Verse</label>
      
      <div class="picker-controls">
        <div class="control-group">
          <label class="control-label">Chapter</label>
          <select 
            [(ngModel)]="selectedEndChapter" 
            (ngModelChange)="onEndChapterChange()"
            class="select-control">
            <option *ngFor="let chapter of endChapters" [value]="chapter">
              {{ chapter }}
            </option>
          </select>
        </div>

        <span class="separator">:</span>

        <div class="control-group">
          <label class="control-label">Verse</label>
          <select 
            [(ngModel)]="selectedEndVerse" 
            (ngModelChange)="onEndVerseChange()"
            class="select-control">
            <option *ngFor="let verse of endVerses" [value]="verse">
              {{ verse }}
            </option>
          </select>
        </div>
      </div>
    </div>
  </div>

  <!-- Validation Message -->
  <div class="validation-warning" *ngIf="!isValidSelection && validationMessage">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
    </svg>
    {{ validationMessage }}
  </div>

  <!-- Selection Display -->
  <div class="selection-display">
    <div class="reference-display">
      <span class="reference-text">
        {{ selectedBook?.name }} {{ selectedChapter }}<!--
        --><span *ngIf="mode === 'single'">:{{ selectedVerse }}</span><!--
        --><span *ngIf="mode === 'range' && (selectedEndChapter !== selectedChapter || selectedEndVerse !== selectedVerse)"><!--
          --><span *ngIf="selectedEndChapter === selectedChapter">:{{ selectedVerse }}-{{ selectedEndVerse }}</span><!--
          --><span *ngIf="selectedEndChapter !== selectedChapter">:{{ selectedVerse }}-{{ selectedEndChapter }}:{{ selectedEndVerse }}</span><!--
        --></span>
      </span>
    </div>
    
    <div class="verse-count">
      <span class="count-number">{{ verseCount }}</span>
      <span class="count-label">{{ verseCount === 1 ? 'verse' : 'verses' }} selected</span>
      <span class="memorized-label" *ngIf="showMemorizedOnly">(memorized only)</span>
    </div>
  </div>
</div>