<div class="journey-drawer-backdrop" 
     [class.visible]="!collapsed" 
     (click)="collapsed = true"></div>

<div class="journey-drawer" 
     [class.open]="!collapsed"
     [class.auto-hide]="autoHide">
  <div class="drawer-header">
    <h2 class="drawer-title">Biblical Journeys</h2>
    <button class="close-btn" (click)="collapsed = true" title="Close panel (Esc)">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>
  
  <div class="drawer-content">
    <!-- Testament Filter -->
    <div class="testament-selector">
      <button 
        class="testament-btn"
        [class.active]="testament === 'Old Testament'"
        (click)="selectTestament('Old Testament')">
        <span class="icon">ğŸ“œ</span>
        <span class="label">Old Testament</span>
      </button>
      <button 
        class="testament-btn"
        [class.active]="testament === 'New Testament'"
        (click)="selectTestament('New Testament')">
        <span class="icon">âœï¸</span>
        <span class="label">New Testament</span>
      </button>
    </div>
    
    <!-- Journey Selector -->
    <div class="journey-selector">
      <label>Select Journey</label>
      <select 
        [value]="currentJourney?.journey_id || ''"
        (change)="onJourneySelect($event)">
        <option value="" disabled>Choose a journey...</option>
        <option 
          *ngFor="let journey of journeys" 
          [value]="journey.journey_id">
          {{ journey.name }}
        </option>
      </select>
    </div>
    
    <!-- Journey Info -->
    <div class="journey-info" *ngIf="currentJourney">
      <h3>{{ currentJourney.name }}</h3>
      <p class="description">{{ currentJourney.description }}</p>
      
      <div class="journey-details">
        <div class="detail-item" *ngIf="currentJourney.scripture_refs">
          <span class="icon">ğŸ“–</span>
          <span class="text">{{ currentJourney.scripture_refs }}</span>
        </div>
        <div class="detail-item" *ngIf="currentJourney.start_year">
          <span class="icon">ğŸ“…</span>
          <span class="text">
            {{ formatYearRange(currentJourney.start_year || null, currentJourney.end_year || null) }}
          </span>
        </div>
        <div class="detail-item" *ngIf="currentJourney.waypoints">
          <span class="icon">ğŸ“</span>
          <span class="text">{{ currentJourney.waypoints.length }} locations</span>
        </div>
      </div>
    </div>
    
    <!-- Journey Stats -->
    <div class="journey-stats" *ngIf="currentJourney">
      <h4>Journey Progress</h4>
      <div class="progress-bar">
        <div 
          class="progress-fill"
          [style.width.%]="progressPercentage">
        </div>
      </div>
      <p class="progress-text">
        {{ currentSegmentIndex + 1 }} of {{ totalSegments }} segments
      </p>
    </div>
  </div>
</div>

<!-- Floating Toggle Button -->
<button class="drawer-toggle" 
        *ngIf="collapsed" 
        (click)="collapsed = false"
        title="Open journey panel (J)">
  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
    <path d="M3 12h18"></path>
    <path d="M3 6h18"></path>
    <path d="M3 18h18"></path>
  </svg>
  <span class="toggle-label">Journeys</span>
</button>