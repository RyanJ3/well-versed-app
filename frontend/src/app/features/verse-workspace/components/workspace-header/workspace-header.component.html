<div class="flow-header-glass" 
     [class.cross-ref-mode]="mode === 'crossReferences'"
     [class.topical-mode]="mode === 'topical'"
     [class.chapter-mode]="mode === 'chapter'">
  <!-- Subtle animated mesh background -->
  <div class="animated-mesh"></div>

  <!-- Main header content -->
  <div class="header-glass-container">
    <!-- Mode selector positioned on the left -->
    <div class="mode-selector-section">
      <app-mode-selector
        [mode]="mode"
        (modeChange)="onModeChange($event)">
      </app-mode-selector>
    </div>

    <!-- Content selectors centered over workspace body -->
    <div class="content-selectors-section">
      <!-- Mode-specific content -->
      <ng-container [ngSwitch]="mode">
        
        <!-- Chapter Mode (verse-by-verse) -->
        <ng-container *ngSwitchCase="'chapter'">
          <div class="selector-group">
            <!-- Book Selector -->
            <app-book-dropdown
              [currentBook]="currentBook"
              [allBooks]="allBooks"
              [hasApocrypha]="hasApocrypha"
              (bookSelect)="onBookSelect($event)">
            </app-book-dropdown>

            <!-- Chapter Selector -->
            <app-chapter-dropdown
              [currentChapter]="currentChapter"
              [availableChapters]="availableChapters"
              (chapterSelect)="onChapterClick($event)">
            </app-chapter-dropdown>
          </div>
        </ng-container>

        <!-- Cross References Mode -->
        <ng-container *ngSwitchCase="'crossReferences'">
          <div class="selector-group">
            <!-- Book Selector -->
            <app-book-dropdown
              [currentBook]="currentBook"
              [allBooks]="allBooks"
              [hasApocrypha]="hasApocrypha"
              (bookSelect)="onBookSelect($event)">
            </app-book-dropdown>

            <!-- Chapter Selector -->
            <app-chapter-dropdown
              [currentChapter]="currentChapter"
              [availableChapters]="availableChapters"
              (chapterSelect)="onChapterClick($event)">
            </app-chapter-dropdown>
            
            <!-- Verse Selector -->
            <app-verse-dropdown
              [selectedVerseNumber]="selectedVerseNumber"
              [availableVerseNumbers]="availableVerseNumbers"
              [memorizedVerses]="memorizedVerses"
              (verseSelect)="onVerseClick($event)">
            </app-verse-dropdown>
          </div>
        </ng-container>

        <!-- Topical Mode -->
        <ng-container *ngSwitchCase="'topical'">
          <!-- Topic Picker (included via ng-content) -->
          <div class="topic-picker-container">
            <ng-content></ng-content>
          </div>
        </ng-container>
      </ng-container>
    </div>
  </div>

  <!-- Verse Picker for Cross References Mode -->
  <ng-content select="app-verse-picker"></ng-content>
</div>