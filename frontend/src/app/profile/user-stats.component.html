<div class="stats-container">
  <h1 class="page-title">Bible Memorization Statistics</h1>

  <div *ngIf="isLoading" class="loading-container">
    <div class="loading-spinner"></div>
  </div>

  <ng-container *ngIf="!isLoading">
    <!-- Overall Stats Cards -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value">{{ totalVerses }}</div>
        <div class="stat-label">Verses Memorized</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ totalChapters }}</div>
        <div class="stat-label">Chapters Completed</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ totalBooks }}</div>
        <div class="stat-label">Books Completed</div>
      </div>
      <div class="stat-card">
        <div class="stat-value">{{ percentComplete }}%</div>
        <div class="stat-label">Bible Progress</div>
      </div>
    </div>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <!-- Testament Progress Pie Chart -->
      <div class="chart-card">
        <h2 class="chart-title">Testament Progress</h2>
        <kendo-chart>
          <kendo-chart-series>
            <kendo-chart-series-item 
              type="pie"
              [data]="testamentProgressData"
              field="value"
              categoryField="category"
              [labels]="pieLabelOptions">
            </kendo-chart-series-item>
          </kendo-chart-series>
          <kendo-chart-legend [visible]="true" position="bottom"></kendo-chart-legend>
        </kendo-chart>
      </div>

      <!-- Book Group Progress Bar Chart -->
      <div class="chart-card">
        <h2 class="chart-title">Progress by Book Group</h2>
        <kendo-chart>
          <kendo-chart-series>
            <kendo-chart-series-item 
              type="column"
              [data]="bookGroupProgressData"
              field="value"
              categoryField="category"
              [color]="'#3b82f6'"
              [labels]="{
                visible: true,
                format: '{0}'
              }">
            </kendo-chart-series-item>
          </kendo-chart-series>
          <kendo-chart-category-axis>
            <kendo-chart-category-axis-item
              [labels]="{
                rotation: -45
              }">
            </kendo-chart-category-axis-item>
          </kendo-chart-category-axis>
          <kendo-chart-value-axis>
            <kendo-chart-value-axis-item
              [title]="{
                text: 'Verses Memorized'
              }">
            </kendo-chart-value-axis-item>
          </kendo-chart-value-axis>
        </kendo-chart>
      </div>
    </div>

    <!-- Top Memorized Books Bar Chart -->
    <div class="chart-card full-width">
      <h2 class="chart-title">Top 10 Most Memorized Books</h2>
      <kendo-chart [style.height.px]="400">
        <kendo-chart-series>
          <kendo-chart-series-item 
            type="bar"
            [data]="topMemorizedBooksData"
            field="value"
            categoryField="category"
            [color]="'#10b981'"
            [labels]="{
              visible: true,
              format: '{0} verses'
            }">
          </kendo-chart-series-item>
        </kendo-chart-series>
        <kendo-chart-category-axis>
          <kendo-chart-category-axis-item>
          </kendo-chart-category-axis-item>
        </kendo-chart-category-axis>
        <kendo-chart-value-axis>
          <kendo-chart-value-axis-item
            [title]="{
              text: 'Verses Memorized'
            }">
          </kendo-chart-value-axis-item>
        </kendo-chart-value-axis>
      </kendo-chart>
    </div>

    <!-- Memorization Trend Line Chart -->
    <div class="chart-card full-width">
      <h2 class="chart-title">Memorization Progress Over Time</h2>
      <kendo-chart>
        <kendo-chart-series>
          <kendo-chart-series-item 
            type="line"
            [data]="memorializationTrendData"
            field="value"
            categoryField="category"
            [markers]="{
              visible: true,
              size: 8
            }"
            [style]="'smooth'">
          </kendo-chart-series-item>
        </kendo-chart-series>
        <kendo-chart-category-axis>
          <kendo-chart-category-axis-item
            [title]="{
              text: 'Month'
            }">
          </kendo-chart-category-axis-item>
        </kendo-chart-category-axis>
        <kendo-chart-value-axis>
          <kendo-chart-value-axis-item
            [title]="{
              text: 'Total Verses'
            }">
          </kendo-chart-value-axis-item>
        </kendo-chart-value-axis>
      </kendo-chart>
    </div>
  </ng-container>
</div>